---
title:  "Membuat Randsomware dengan PGP" 
permalink: /posts/2021/03/membuat-randsomeware-dengan-gpg
date: 2021-03-20-00
---

**_Catatan:_** Tutorial untuk tingkat lanjutan.

# langkah - langkah tutorial 

1. Generate keys
2. mengunci file  dengan public key
3. membuka file  dengan private key
4. import key dari user lain
5. memberi dokumen file document
6. verify signature


# 1.Install package
```python
sudo pip3 install python-gnupg
```
# 2.Membuat file

```bash
touch pgp_keygen.py
```
<br>

# 3.Buat program python untuk membuat keygen 

```python
import gnupg
import os 

# Directory gnupg
gpg=gnupg.GPG(gnupghome='/home/supernode/.gnupg')

gpg.encoding = 'utf-8'

# Data untuk membuat gpg
input_data = gpg.gen_key_input(
        name_email = 'jon@mantap.com',
        passphrase = 'rahasia',
        key_type   = 'RSA',
        key_length = 1024)


key = gpg.gen_key(input_data)

print(key)

```

### jalankan program.

<br>

```bash
python3 pgp_keygen.py
```

### output dari program: 

```bash
24FAC58E8AA95E855C18EDD2285A28E549718FA9
```


setelah itu chek apakah gpg berhasil dibuat. 

```bash
gpg -k 
```

output dari perintah tersebut seperti ini. 

```bash
pub   rsa1024 2021-03-20 [SCEA]
      `**24FAC58E8AA95E855C18EDD2285A28E549718FA9**`
uid           [ultimate] Autogenerated Key <jon@mantap.com>
```



4.Enkripsi file

tulislah sebuah file program python seperti dibawah ini. 

```python
import gnupg
import os 

# Folder GPG
gpg = gnupg.GPG(gnupghome = '/home/supernode/.gnupg')

# Lokasi file
path = '/home/supernode/Textfile'

# File yang akan di enkripsi
ptfile = '/debug'

with open(path +ptfile, 'rb') as f:
    status = gpg.encrypt_file(f, recipients = ['jon@mantap.com'], 
    # Ouput file enkripsi 
    output=path + ptfile + ".encrypted")

print(status.ok)
print(status.stderr)

```

jika sudah jalan kan program 

```bash
python3 gpg_encrypted.py 

# kemudian buka folder hasil dari output enkripsi
cd ../Texfile

```

File yang belum di enkripsi sebelumnya 
```bash
cat debug

PING google.com (216.239.38.120) 56(84) bytes of data.
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=1 ttl=57 time=19.5 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=2 ttl=57 time=22.8 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=3 ttl=57 time=21.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=4 ttl=57 time=20.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=5 ttl=57 time=20.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=6 ttl=57 time=20.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=7 ttl=57 time=20.4 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=8 ttl=57 time=20.7 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=9 ttl=57 time=23.0 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=10 ttl=57 time=20.0 ms

--- google.com ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9016ms
rtt min/avg/max/mdev = 19.581/20.913/23.020/1.103 ms
```


Keluaran file yang sudah di enkripsi

```bash
cat debug.encrypted

----BEGIN PGP MESSAGE-----

hIwDKFoo5Ulxj6kBA/9uRsmd/Xwjs05Yxf0W17F5nWeXlyInViVYNMuRZEvLEHCG
gxG658SsvCVS+iaaTMWmJiiG3hxL6MwjgdYAtHfZoWgqTxlzFnpNhVpqM3y2m37b
uhmt6YuXtx39WDrQgAGr7J9BxPvf1e3jcYdz1Dia9vN6j2a16HX5tCDdBZNQXNLA
jAGmDSHlcYq9rztKYXvj155QX0sYWUSuBX/20JBq4cPF445uvgwkmljYyznTZoBC
TA4+8ISU7mKoKnPUnSD3546h2RcJLIhjdmGwzUbUJP/c8x2+dyciRrNET5wKUU3t
In8qSqK6FHQZvYmBEBIXJAE7wQB0XA5Q+9Q3iIEdnkzFiY0WrDJp1iUBMh/JCT4e
WpnDJiEaxVxMsHd+U1s84vk6tR6aGM1HWz0WOF+bWxSrw9vPheSRC6ybWLNQp3/+
izaj2YDBmGukGYTK5fz8vz0IvNdwFQFkSG32zfu5r8/t04CaDJxW0U1dxiSoEVAG
wEmP5We5Sz5cUpgtdlWdCyZzDGf0YGMCOn1y1EUv04/CoIB9IxPAYw0ZKSwiFdu+
REQ26Y5sOiyRU6H77RinPlOOAsRpcOm2+ApwepLHJfPUBBdmwmmLpiZ/BKNU
=PZfF
-----END PGP MESSAGE-----

```

oke, setelah kita berhasil membuat enkripsi file, sekrang kita coba untuk membuat decrypted filenya. 



# 5. Dekripsi file 

## 1. Tulis code 

tulis code program dibawah ini.

```python

import gnupg
import os


# Folder GPG
gpg = gnupg.GPG(gnupghome = '/home/supernode/.gnupg')

# Lokasi file
path = '/home/supernode/Textfile'

# File yang akan di enkripsi
ptfile = '/debug.encrypted'

with open(path+ptfile, 'rb' ) as f:
    status = gpg.decrypt_file(f, passphrase = 'rahasia', output = path+ptfile +".decrypted")

print(status.ok)
print(status.stderr)

```

## 2. Jalankan program

setelah program kita buat, langkah selanjutnya menjalankan program.

```bash
python3 pgp_decrypt.py
```

setelah program dijalankan makan output dari terminal akan menampilkan pesan seperti ini.

```bash
True
[GNUPG:] ENC_TO 285A28E549718FA9 1 0
[GNUPG:] KEY_CONSIDERED 24FAC58E8AA95E855C18EDD2285A28E549718FA9 0
[GNUPG:] KEY_CONSIDERED 24FAC58E8AA95E855C18EDD2285A28E549718FA9 0
[GNUPG:] DECRYPTION_KEY 24FAC58E8AA95E855C18EDD2285A28E549718FA9 24FAC58E8AA95E855C18EDD2285A28E549718FA9 u
[GNUPG:] KEY_CONSIDERED 24FAC58E8AA95E855C18EDD2285A28E549718FA9 0
gpg: encrypted with 1024-bit RSA key, ID 285A28E549718FA9, created 2021-03-20
      "Autogenerated Key <jon@mantap.com>"
[GNUPG:] BEGIN_DECRYPTION
[GNUPG:] DECRYPTION_INFO 2 9
[GNUPG:] PLAINTEXT 62 1616228202 
[GNUPG:] DECRYPTION_OKAY
[GNUPG:] GOODMDC
[GNUPG:] END_DECRYPTION
```

kemudian kita lihat hasil dari progam yang telah kita dekripsi, seperti output dibawah ini: 

```bash
upernode@labs:~/pgp$ cat ../Textfile/debug.encrypted.decrypted 
PING google.com (216.239.38.120) 56(84) bytes of data.
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=1 ttl=57 time=19.5 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=2 ttl=57 time=22.8 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=3 ttl=57 time=21.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=4 ttl=57 time=20.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=5 ttl=57 time=20.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=6 ttl=57 time=20.3 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=7 ttl=57 time=20.4 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=8 ttl=57 time=20.7 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=9 ttl=57 time=23.0 ms
64 bytes from any-in-2678.1e100.net (216.239.38.120): icmp_seq=10 ttl=57 time=20.0 ms

--- google.com ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9016ms
rtt min/avg/max/mdev = 19.581/20.913/23.020/1.103 ms
```

jika file sudah kembali seperti semula artinya program kita telah berhasil untuk mendekripsi file. 